<!DOCTYPE html>
<html lang="en">
<head>

  <!-- Basic Page Needs
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta charset="utf-8">
  <title>Dave's Simple Chat Service in Node.js</title>
  <meta name="description" content="">
  <meta name="author" content="">

  <!-- Mobile Specific Metas
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- FONT
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link href="//fonts.googleapis.com/css?family=Raleway:400,300,600" rel="stylesheet" type="text/css">

  <!-- CSS
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link rel="stylesheet" href="css/normalize.css">
  <link rel="stylesheet" href="css/skeleton.css">
  <style>
    .container {

    }

    #header {
      position: fixed;
      top: 0;
      height: 45px;
      width: 100%;
      background: #ffffff;
    }

    #getName {
      padding-top: 30px;
    }

    #messages {
      list-style-type: none;
      margin: 0;
      padding-top: 10px;
      margin-bottom: 5px !important;
      }

    #messages li {
      padding: 5px 10px; }

    #messages li:nth-child(odd) {
      background: #eee; }

    #m {
      width: 300px;
    }

    #sendMessage {
      position: fixed;
      bottom: 0;
      margin-bottom: 0 !important;
      height: 50px;
      /*height: 40px;*/
      background: #ffffff;
      width: 100%;
    }
  </style>

  <!-- Favicon
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link rel="icon" type="image/png" href="images/favicon.png">

</head>
<body>

  <!-- Primary Page Layout
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <div class="container" style="margin-bottom:50px;">
    <div class="row">
      <div class="twelve columns" style="margin-top: 5%">
        <div id="header">
          <h4>Dave's Simple Chat Service</h4>
        </div>
        <div id="getName">
          <form id="user">
            <p>What is your username?</p>
            <input id="un" autocomplete="off" />
            <button>Submit Username</button>
          </form>
        </div>

        <div id="messageContainer">
          <p id="messages"></p>
        </div>
      </div>
    </div>
  </div>

  <div class="container">
    <form id="sendMessage" action="">
      <input id="m" autocomplete="off" />
      <button>Send Message</button>
    </form>
  </div>


<!-- End Document
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <script type="text/javascript" src="/socket.io/socket.io.js"></script>
  <script src="http://code.jquery.com/jquery-1.11.1.js"></script>
  <script>

  $('#sendMessage').hide();
  $('#messages').hide();

    var socket = io();
    $('#getName').submit(function () {
      socket.emit('username', $('#un').val());
      $('#getName').hide();
      $('#messages').show();
      $('#sendMessage').show();
      return false;
    })


    $('#sendMessage').submit(function () {
      socket.emit('chat message', $('#m').val());
      $('#m').val('');
      window.scrollTo(0,document.body.scrollHeight); // Always scroll down to your latest message
      return false;
    });

    socket.on('chat message', function(username, msg){
      $('#messages').append($('<li><strong>' + username + ':</strong> ' + msg + '</li>'));

    });

    console.log(test);

  </script>
</body>
</html>
